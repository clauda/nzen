<div class="pageheader">
  <h1>Dashboard</h1>
  <p class="description">Painel Administrativo</p>
</div>

<section id="main-content">
  <div class="row">
    <div class="col-md-12 col-lg-6">
      <div class="row">
        <div class="col-md-6">
          <div class="panel panel-solid-success widget-mini">
            <div class="panel-body">
              <i class="icon-bar-chart"></i>
              <span class="total text-center">$3,200</span>
              <span class="title text-center">Earnings</span>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="panel panel-solid-danger widget-mini">
            <div class="panel-body">
              <i class="icon-support"></i>
              <span class="total text-center"><%= @issues.size %></span>
              <span class="title text-center"><%= link_to "Chamados Abertos", admin_issues_path %></span>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="panel panel-solid-primary widget-mini">
            <div class="panel-body">
              <i class="icon-briefcase"></i>
              <span class="total text-center"><%= @services.size %></span>
              <span class="title text-center"><%= link_to "Empresas para Moderar", moderate_admin_services_path %></span>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="panel panel-solid-info widget-mini">
            <div class="panel-body">
              <i class="icon-user"></i>
              <span class="total text-center"><%= @users.size %></span>
              <span class="title text-center"><%= link_to "Usuários Cadastrados", admin_users_path %></span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xs-12 col-sm-6 col-md-6 col-lg-3">
      <div class="panel">
        <div class="panel-heading">
          <h3 class="panel-title">Últimos 30 dias</h3>
        </div>
        <div class="panel-body">
          <i class="icon-user"></i>
          <span class="total text-center"><b><%= @users.latest.size %></b></span>
          <span class="title text-center">novos usuários</span>
          <hr />
          <i class="icon-briefcase"></i>
          <span class="total text-center"><b><%= @services.latest.size %></b></span>
          <span class="title text-center">novas empresas</span>
        </div>
      </div>
    </div>
  </div>

  <div id="results"></div>

</section>


<% content_for :javascript do %>
  <script src="https://apis.google.com/js/client.js?onload=loadLib"</script>

  <script type="text/javascript">
    function makeApiCall(){
      var apiQuery = gapi.client.analytics.data.ga.get({
        'ids': 'ga:2347706',
        'start-date': '2010-01-01',
        'end-date': '2010-01-15',
        'metrics': 'ga:sessions',
        'dimensions': 'ga:source,ga:keyword',
        'sort': '-ga:sessions,ga:source',
        'filters': 'ga:medium==organic',
        'max-results': 25
      });
      apiQuery.execute(handleCoreReportingResults);
    };

    function handleCoreReportingResults(results) {
      if (!results.error) {
        console.log('works');
      } else {
        console.log('There was an error: ' + results.message);
      }
    };

    $(function(){
      function loadLib(){
        gapi.client.load('analytics', 'v3', makeApiCall);
      };
    });
  </script>

<% end %>

